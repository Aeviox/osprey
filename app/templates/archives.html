<!doctype html>
{% extends "base.html" %}

{% block app_content %}
    <script>
        var SESSION_ID = "{{session_id}}";
        var VIDEO_REQUEST_URL = "{{url_for('videoframefetch', frame='FRAME', session='SESSION', sensor='SENSOR')}}";
        var AUDIO_REQUEST_URL = "{{url_for('audiosegmentfetch', timestamp='TIMESTAMP', segment='SEGMENT', session='SESSION', sensor='SENSOR')}}";
        var SESSION_SENSORS = JSON.parse('{{session_sensors_serialized}}'.replace(/&#34;/g, '"'));
        var SESSION_START_TIME = "{{session_start_time}}";
        var SESSION_END_TIME = "{{session_end_time}}";
    </script>
    <script src="../static/JS/playback.js"></script>
    <script src="../static/JS/archive_buttons.js"></script>

    <div class = "row p-2 justify-content-start ">
        <div class="col-3">
            <div class = "card w-100 mt-1 bg-light rounded">
                <div class = "card-header p-0 text-center">
                    Audio Sensors
                </div>
                <div style="text-align: center;" class="card-body p-1">
                    {% for mic in microphones %}
                    <div id="sensor-box-{{mic.sensor_id}}-{{mic.sensor_type}}" class="hide">
                        <p style="margin-bottom: 0em !important;">{{mic.name}}</p>
                        <div class="row">
                            <div class="col">
                                <audio id="audio-{{mic.sensor_id}}" style="margin-bottom: 0.5em;" class="audio-player" controls>
                                    Your browser doesn't support HTML audio element.
                                </audio>
                            </div>
                        </div>
                        <div class="row justify-content-end">
                            <div class="col text-left" id="decibels">
                                
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>


        <div class="col-6">
            {% for camera in cameras %}
                <div id="sensor-box-{{camera.sensor_id}}-{{camera.sensor_type}}" class="hide card w-100 bg-light rounded">
                    <div class = "card-header p-0 text-center">
                        {{camera.name}}
                    </div>
                    <div class = "card-body p-1">
                        <img id="session-video-{{session_id}}-{{camera.sensor_id}}" last-frame-number="{{camera.last_frame_number}}" width="100%">
                    </div>
                </div>
            {% endfor %}
            <div class = "col mt-1 border border-dark rounded bg-white">
                <div class="row justify-content-center">
                    <span id="elapsed-time" style="padding: 10px; margin-top: 0.5em; margin-right: 1.5em;" class="bg-white border border-dark rounded">
                        Elapsed Time: 01:32:17
                    </span>
                    <span id="archive-time" style="padding: 10px; margin-top: 0.5em;" class="bg-white border border-dark rounded">
                        Archive Time: 01:32:17
                    </span>
                </div>
                <div class = "card-header text-left bg-white">
                    <span class="playback-controls">
                        <button id='play-button' class="paused"></button>
                    </span>
                    <input type="range" min="{{(session_start_time + 1)|int}}" max="{{(session_end_time - 1)|int}}" value="{{(session_start_time + 1)|int}}" class="slider" id="playback-slider" oninput="on_slider_input(this.value)">
                </div>
            </div>
        </div>


        
        <div class="col-3">
            <div class = "card w-100 bg-light rounded">
                <div class = "card-header p-0 text-center">
                    Sensor Selection
                </div>
                <div class = "card-body p-1">
                    <div class="row">
                    {% for sensor in sensor_selections %}
                        <div class="col">
                            <div class="custom-control custom-checkbox" onclick="sensor_selection_clicked({{sensor.sensor_id}}, '{{sensor.sensor_type}}')">
                                <input type="checkbox" class="custom-control-input" id="checkbox-{{sensor.sensor_id}}-{{sensor.sensor_type}}">
                                <label class="custom-control-label" for="defaultChecked1">{{sensor.sensor_name}}</label>
                            </div>
                        </div>
                        {% if sensor.index % 2 == 0 and sensor.index != 1 %}
                        </div>
                        <div class="row">
                        {% endif %}
                    {% endfor %}
                    </div>
                </div>
            </div>

            <div style="margin-top: 1em" class="card w-100">
                <div class="card-header p-0 text-center">
                    Event Log
                </div>
                <ul style="text-align: center; max-height: 13em;" class="list-group list-group-flush p-1" id="eventLog">
                </ul>
            </div>

            {% for sense in sense_hats %}
                <div style="margin-top: 1em;" id="sensor-box-{{sense.sensor_id}}-{{sense.sensor_type}}" class="hide card w-100 bg-light rounded">
                    <div class = "card-header p-0 text-center">
                        {{sense.name}}
                    </div>
                    <div class = "card-body p-1">
                        <div class="row temp-spacing">
                            <div class="col-8">
                                Temperature (&#8457):
                            </div>
                            <div class="col-4 text-right" id="sense-temperature-{{sense.sensor_id}}">
                                --.-
                            </div>
                        </div>
                        <div class="row temp-spacing">
                            <div class="col-8">
                                Air Pressure (millibars):
                            </div>
                            <div class="col-4 text-right" id="sense-pressure-{{sense.sensor_id}}">
                                --.-
                            </div>
                        </div>
                        <div class="row temp-spacing">
                            <div class="col-8">
                                Air Humidity (%):
                            </div>
                            <div class="col-4 text-right" id="sense-humidity-{{sense.sensor_id}}">
                                --.-
                            </div>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>
{% endblock %}